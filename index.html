<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=8"/>
    <title>Fair Value Calculator</title>
    <meta name="description" content="Fair Value Calculator"/>
    <style>
      .years td{
          text-align: center;
      }
      th {
          text-align: right;
      }
    </style>
  </head>
  <body>
    With and without drip!
    With and without tax!
    <form action="#" type="post" onsubmit="return false;">
      <table>
	<tr>
	  <th>Yield:</th>
	  <td><input type="text" id="yield" name="yield"/></td>
	</tr>
	<tr>
	  <td colspan="2">
            <table class="years">
              <tr><th>Tax</th><th>Years</th></tr>
              <tr><th>0%</th><td id="t0"></td></tr>
              <tr><th>10%</th><td id="t10"></td></tr>
              <tr><th>15%</th><td id="t15"></td></tr>
              <tr><th>25%</th><td id="t25"></td></tr>
              <tr><th>37%</th><td id="t37"></td></tr>
            </table>
          </td>
	</tr>
	<tr>
	  <td><input type="submit" id="calculate" value="Calculate"/></td>
	</tr>
      </table>
    </form>

    <script type="module">
      let $c = document.getElementById('calculate');
      function calc($t) {
          let $i = 1.0;
          let $y = parseFloat(document.getElementById('yield').value,10) / 100;
          let years = 0;
          let total = 0;
          let pay = 0;
          let initial = $i;

          $t = 1.0 - ($t/100);
          while (total < initial) {
              pay = ($i * $y * $t);
              total += pay;
              $i += pay;
              years += 1;
          }
          return years;
      };
      $c.onclick = function() {
          document.getElementById('t0').innerHTML = calc(0);
          document.getElementById('t10').innerHTML = calc(10);
          document.getElementById('t15').innerHTML = calc(15);
          document.getElementById('t25').innerHTML = calc(25);
          document.getElementById('t37').innerHTML = calc(37);
	  return false;
      };
    </script>
  </body>
</html>
