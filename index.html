<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=8"/>
    <title>Fair Value Calculator</title>
    <meta name="description" content="Fair Value Calculator"/>
    <style>
      th {
          text-align: right;
      }
    </style>
  </head>
  <body>
    <form action="#" type="post" onsubmit="return false;">
      <table>
	<tr>
	  <th>Initial Investment:</th>
	  <td><input type="text" id="investment" name="investment"/></td>
	</tr>
	<tr>
	  <th>Yield:</th>
	  <td><input type="text" id="yield" name="yield"/></td>
	</tr>
	<tr>
	  <th>Cycles per year:</th>
	  <td><input type="text" id="cpy" name="cpy"/></td>
	</tr>
	<tr>
	  <th>Tax:</th>
	  <td><input type="text" id="tax" name="tax"/></td>
	</tr>
	<tr>
	  <th>Return of investment cycles:</th>
	  <td id="cycles"></td>
	</tr>
	<tr>
	  <th>Years:</th>
	  <td id="years"></td>
	</tr>
	<tr>
	  <td><input type="submit" id="calculate" value="Calculate"/></td>
	</tr>
      </table>
    </form>

    <script type="module">
      let $c = document.getElementById('calculate');
      $c.onclick = function() {
          let $i = parseFloat(document.getElementById('investment').value,10);
          let $y = parseFloat(document.getElementById('yield').value,10) / 100;
          let $cy = document.getElementById('cycles');
          let $ys = document.getElementById('years');
          let $cpy = parseFloat(document.getElementById('cpy').value,10) || 1.0;
          let $t = parseFloat(document.getElementById('tax').value,10) || 1.0;
          let cycles = 0;
          let total = 0;
          let pay = 0;
          let initial = $i;

          $t = 1.0 - ($t/100);
          while (total < initial) {
              pay = ($i * $y * $t);           
              total += pay;
              $i += pay;
              cycles += 1;	  
          }
          $cy.innerHTML = cycles;
          $ys.innerHTML = cycles / $cpy;
	  return false;
      };
    </script>
  </body>
</html>
